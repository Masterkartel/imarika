<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Imarika — Invest with Confidence</title>
  <meta name="description" content="Imarika Investments: secure, transparent investment plans and working-capital loans with human support. Payments via M-Pesa or Bank." />

  <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
  <link rel="icon" href="/favicon.png" sizes="32x32" />
  <link rel="apple-touch-icon" href="/favicon.png" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#ffffff; --text:#0f172a; --muted:#475569; --line:#e5e7eb; --card:#ffffff;
      --brand:#f59e0b; --brand-soft:#fde68a; --ok:#16a34a; --danger:#ef4444;
      --ring:rgba(245,158,11,.35);
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
    body{overflow-x:hidden; padding-bottom:84px;}
    a{text-decoration:none;color:inherit}
    .container{max-width:1120px;margin:0 auto;padding:0 1rem}
    @media (max-width:600px){.container{padding:0 .9rem}}

    .btn{display:inline-flex;align-items:center;justify-content:center;padding:.85rem 1.1rem;border-radius:14px;font-weight:700;
      background:var(--brand);color:#111827;cursor:pointer;border:0;box-shadow:0 10px 30px rgba(245,158,11,.25);transition:.2s}
    .btn:hover{transform:translateY(-1px);background:#fbbf24}
    .btn-outline{background:#fff;border:1px solid var(--line);color:var(--text);box-shadow:none}
    .btn-outline:hover{border-color:#cbd5e1}
    .btn-wa{background:#25D366;color:#fff;box-shadow:0 12px 30px rgba(16,185,129,.35)}
    .btn-wa:hover{filter:brightness(1.05)}
    .btn-full{width:100%}

    header{position:sticky;top:0;background:rgba(255,255,255,.9);backdrop-filter:blur(8px);border-bottom:1px solid var(--line);z-index:40}
    .brand{display:flex;align-items:center;gap:.55rem;min-width:0}
    .logo{height:32px;width:32px;border-radius:10px;flex:0 0 auto}
    .badge{padding:.18rem .6rem;border-radius:999px;background:#fef3c7;color:#78350f;font-weight:700;font-size:.75rem;white-space:nowrap}
    @media(max-width:420px){.badge{font-size:.7rem;padding:.12rem .5rem}}
    .menuBtn{display:none;border:1px solid var(--line);background:#fff;border-radius:10px;padding:.5rem}
    @media (min-width: 901px){ .menuBtn{display:inline-flex} }
    nav.desktop{display:none}
    @media (max-width:900px){.desktop-only{display:none}}

    section{padding:3.2rem 0}
    @media(max-width:600px){section{padding:2.2rem 0}}
    h1{font-size:clamp(1.8rem, 5vw, 3rem);line-height:1.1;margin:.2rem 0 1rem;word-break:break-word}
    @media(max-width:380px){h1{font-size:1.65rem;line-height:1.15}}
    h2{font-size:clamp(1.45rem, 4vw, 2.2rem);margin:0 0 1rem}
    .muted{color:var(--muted)}
    .grid{display:grid;gap:1rem}
    .grid-2{grid-template-columns:1fr}
    .grid-3{grid-template-columns:1fr}
    @media(min-width:768px){.grid-3{grid-template-columns:repeat(3,1fr)}.grid-2{grid-template-columns:repeat(2,1fr)}}
    .card{background:var(--card);border:1px solid var(--line);border-radius:18px;padding:1.15rem;
      box-shadow:0 10px 30px rgba(2,8,23,.06);transition:transform .18s ease, box-shadow .18s ease}
    .card:hover{transform:translateY(-3px);box-shadow:0 18px 40px rgba(2,8,23,.10)}
    @media(max-width:600px){.card{padding:1rem}}

    input,select,textarea{width:100%;padding:.85rem;border:1px solid var(--line);border-radius:14px;outline:none}
    input:focus,select:focus,textarea:focus{border-color:#cbd5e1;box-shadow:0 0 0 4px var(--ring)}
    .helper{font-size:.95rem;color:var(--muted)}
    @media(max-width:600px){.helper{font-size:.97rem}}

    .hero{
      padding:5.2rem 0 2.2rem; position:relative; overflow:hidden;
      background:radial-gradient(1100px 500px at 75% -10%, #fff7ed 0%, transparent 60%);
    }
    @media(max-width:600px){.hero{padding:4.2rem 0 1.8rem}}
    .hero::after{
      content:"";position:absolute;inset:-20%;background:
        radial-gradient(600px 300px at 20% 10%, rgba(245,158,11,.10), transparent 60%),
        radial-gradient(500px 250px at 90% 0%, rgba(253,230,138,.12), transparent 60%);
      animation:shine 8s linear infinite alternate; pointer-events:none;
    }
    .btnrow{display:flex;gap:.7rem;flex-wrap:wrap}
    @media(max-width:600px){.btnrow .btn{flex:1 1 100%}}

    .sticky-cta{position:fixed;bottom:0;left:0;right:0;background:#fff;border-top:1px solid var(--line);
      display:none;gap:.7rem;align-items:center;justify-content:center;padding:.6rem env(safe-area-inset-bottom,.6rem);z-index:45}
    @media(max-width:900px){.sticky-cta{display:flex}}

    .wa-float{position:fixed;right:16px;bottom:96px;z-index:50}
    .wa-btn{height:58px;width:58px;border-radius:999px;display:flex;align-items:center;justify-content:center;background:#25D366;color:#fff;
      box-shadow:0 12px 30px rgba(16,185,129,.35)}

    table{border-collapse:collapse;width:100%}
    th,td{border:1px solid var(--line);padding:.7rem}
    th{background:#fef3c7}

    #deskMenu{display:none;position:absolute;right:1rem;top:64px;background:#fff;border:1px solid var(--line);
      box-shadow:0 20px 40px rgba(2,8,23,.12);border-radius:12px;z-index:60;overflow:hidden}
    #deskMenu a{display:block;padding:.8rem 1rem;border-bottom:1px solid #f1f5f9}
    #deskMenu a:last-child{border-bottom:0}
    #deskMenu a:hover{background:#f8fafc}

    #mobileNav{display:none}
    footer{border-top:1px solid var(--line);padding:2.2rem 0;color:#475569}

    /* Auth modal/sections */
    .modal{position:fixed;inset:0;background:rgba(2,8,23,.45);display:none;align-items:center;justify-content:center;z-index:80;padding:1rem}
    .modal.active{display:flex}
    .sheet{width:100%;max-width:520px;background:#fff;border:1px solid var(--line);border-radius:16px;padding:1rem;box-shadow:0 30px 60px rgba(2,8,23,.25)}
    .sheet h3{margin:.2rem 0 .8rem}
    .row{display:grid;gap:.6rem}

    /* Dashboard */
    .dash-grid{display:grid;gap:1rem}
    @media(min-width:768px){.dash-grid{grid-template-columns:2fr 1fr}}
    .kpi{display:flex;align-items:center;justify-content:space-between}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
    .tag{display:inline-flex;align-items:center;gap:.35rem;background:#f1f5f9;border:1px solid #e2e8f0;border-radius:999px;padding:.25rem .6rem;font-weight:700}
  </style>
</head>
<body>

  <!-- Header -->
  <header>
    <div class="container" style="display:flex;align-items:center;justify-content:space-between;height:64px;gap:.6rem">
      <a href="#home" class="brand" style="min-width:0">
        <img src="/favicon.svg" class="logo" alt="Imarika logo">
        <strong style="white-space:nowrap">Imarika</strong>
        <span class="badge">Secure & Transparent</span>
      </a>

      <!-- Actions on the right: Login + Get Started (Signup) -->
      <div class="desktop-only" style="display:flex;align-items:center;gap:.6rem">
        <button class="btn btn-outline" id="loginBtn">Login</button>
        <button class="btn" id="signupBtn">Get Started</button>
        <button class="menuBtn" id="deskMenuBtn" aria-label="Open menu">
          <svg width="22" height="22" viewBox="0 0 24 24" fill="none">
            <path d="M4 6h16M4 12h16M4 18h16" stroke="#334155" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- Desktop vertical drawer -->
    <div id="deskMenu">
      <a href="#home">Home</a>
      <a href="#plans">Our Investments</a>
      <a href="#loans">Working-Capital</a>
      <a href="#compare">Compare Plans</a>
      <a href="#choose">Why Us</a>
      <a href="#about">About</a>
      <a href="#testimonials">Clients</a>
      <a href="#faq">FAQ</a>
      <a href="#contact">Contact</a>
    </div>
  </header>

  <!-- Hero -->
  <section id="home" class="hero">
    <div class="container">
      <h1>Welcome to <span style="background:linear-gradient(90deg,#fde68a,#f59e0b);-webkit-background-clip:text;background-clip:text;color:transparent">Imarika</span></h1>
      <p class="muted">Secure and transparent investment opportunities with guaranteed growth and working-capital loans. Human support on WhatsApp and email.</p>
      <div class="btnrow" style="margin-top:1rem">
        <button class="btn" id="ctaSignup">Get Started</button>
        <button class="btn btn-outline" id="ctaLogin">Login</button>
        <a class="btn btn-wa" href="https://wa.me/254701017246?text=Hi%20Imarika!%20I%27d%20like%20to%20get%20started." style="color:#fff">
          <!-- WA icon -->
          <svg aria-hidden="true" viewBox="0 0 24 24" width="18" height="18" fill="currentColor" style="margin-right:.45rem">
            <path d="M20.52 3.48A11.94 11.94 0 0 0 12.06 0C5.52 0 .2 5.32.2 11.86c0 2.08.55 4.08 1.58 5.86L0 24l6.43-1.67a11.82 11.82 0 0 0 5.63 1.43h.01c6.54 0 11.86-5.32 11.86-11.86 0-3.17-1.23-6.14-3.41-8.42zM12.06 21.3h-.01a9.5 9.5 0 0 1-4.85-1.31l-.35-.2-3.82.99 1.02-3.73-.23-.38a9.46 9.46 0 0 1-1.45-5.01c0-5.23 4.26-9.49 9.51-9.49 2.54 0 4.93.99 6.72 2.78a9.43 9.43 0 0 1 2.78 6.71c0 5.23-4.26 9.49-9.52 9.49zm5.47-7.14c-.3-.15-1.77-.87-2.04-.97-.27-.1-.47-.15-.66.15s-.76.97-.92 1.17c-.17.2-.34.22-.63.07-.3-.15-1.26-.46-2.4-1.47-.89-.79-1.49-1.77-1.66-2.07-.17-.3-.02-.46.13-.61.13-.13.3-.34.45-.51.15-.17.2-.3.3-.5.1-.2.05-.37-.02-.53-.07-.15-.66-1.6-.91-2.18-.24-.58-.48-.5-.66-.51l-.56-.01c-.2 0-.53.08-.8.37-.27.3-1.05 1.02-1.05 2.49s1.08 2.89 1.24 3.09c.15.2 2.12 3.22 5.14 4.52.72.31 1.28.5 1.72.64.72.23 1.38.2 1.9.12.58-.09 1.77-.72 2.02-1.41.25-.69.25-1.28.17-1.41-.08-.13-.28-.21-.58-.36z"/>
          </svg>
          Chat on WhatsApp
        </a>
      </div>
    </div>
  </section>

  <!-- ===== Existing marketing sections (Quick Facts, Plans, Loans, Compare, Why, About, Testimonials, FAQ) remain unchanged for brevity ===== -->
  <!-- Keep your previous sections here exactly as before (I left them out to keep this snippet focused). -->

  <!-- Dashboard (hidden until logged in) -->
  <section id="dashboard" style="display:none;background:#fafafa">
    <div class="container">
      <h2>Dashboard</h2>
      <div class="tag mono" id="acctTag">Acct: —</div>

      <div class="dash-grid" style="margin-top:1rem">
        <div class="grid">
          <div class="card">
            <div class="kpi">
              <div>
                <strong>Wallet Balance</strong>
                <div class="muted">Available to invest/withdraw</div>
              </div>
              <div style="text-align:right">
                <div style="font-size:1.6rem;font-weight:800" id="walletBal">KES 0</div>
                <div class="muted mono" id="walletUpdated">Updated just now</div>
              </div>
            </div>
            <div style="margin-top:1rem;display:flex;gap:.6rem;flex-wrap:wrap">
              <button class="btn" id="depositBtn">Deposit via M-Pesa</button>
              <button class="btn btn-outline" id="withdrawBtn" disabled>Withdraw</button>
            </div>
          </div>

          <div class="card">
            <div class="kpi">
              <div>
                <strong>Investments (Shares)</strong>
                <div class="muted">Active amount in plans</div>
              </div>
              <div style="text-align:right">
                <div style="font-size:1.4rem;font-weight:800" id="invBal">KES 0</div>
              </div>
            </div>
            <div class="helper" style="margin-top:.6rem">We’ll show plan breakdowns here later.</div>
          </div>
        </div>

        <div class="card">
          <strong>Quick Calculator</strong>
          <div class="helper">Preview 24h payout & start</div>
          <div class="row" style="margin-top:.6rem">
            <select id="miniPlan">
              <option value="std">Standard (30%)</option>
              <option value="gold">Gold (50%)</option>
              <option value="plat">Platinum (70%)</option>
            </select>
            <input id="miniAmt" type="number" min="1000" placeholder="Enter amount">
            <button class="btn" id="miniCalcBtn">Calculate</button>
            <div class="helper" id="miniOut"></div>
            <button class="btn btn-full" id="miniStartBtn">Start & Deposit</button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Contact + Footer (unchanged from your file) -->
  <section id="contact">
    <div class="container">
      <h2>Get in Touch</h2>
      <div class="grid grid-2" style="margin-top:1rem">
        <div class="card">
          <ul style="list-style:none;padding:0;margin:0;display:grid;gap:.5rem">
            <li>✉️ <a class="muted" href="mailto:sales@imarika.net">sales@imarika.net</a></li>
            <li>📞 +254 701 017 246</li>
            <li style="display:flex;align-items:center;gap:.5rem">
              <svg aria-hidden="true" viewBox="0 0 24 24" width="18" height="18" fill="#25D366" style="flex-shrink:0">
                <path d="M20.52 3.48A11.94 11.94 0 0 0 12.06 0C5.52 0 .2 5.32.2 11.86c0 2.08.55 4.08 1.58 5.86L0 24l6.43-1.67a11.82 11.82 0 0 0 5.63 1.43h.01c6.54 0 11.86-5.32 11.86-11.86 0-3.17-1.23-6.14-3.41-8.42zM12.06 21.3h-.01a9.5 9.5 0 0 1-4.85-1.31l-.35-.2-3.82.99 1.02-3.73-.23-.38a9.46 9.46 0 0 1-1.45-5.01c0-5.23 4.26-9.49 9.51-9.49 2.54 0 4.93.99 6.72 2.78a9.43 9.43 0 0 1 2.78 6.71c0 5.23-4.26 9.49-9.52 9.49zm5.47-7.14c-.3-.15-1.77-.87-2.04-.97-.27-.1-.47-.15-.66.15s-.76.97-.92 1.17c-.17.2-.34.22-.63.07-.3-.15-1.26-.46-2.4-1.47-.89-.79-1.49-1.77-1.66-2.07-.17-.3-.02-.46.13-.61.13-.13.3-.34.45-.51.15-.17.2-.3.3-.5.1-.2.05-.37-.02-.53-.07-.15-.66-1.6-.91-2.18-.24-.58-.48-.5-.66-.51l-.56-.01c-.2 0-.53.08-.8.37-.27.3-1.05 1.02-1.05 2.49s1.08 2.89 1.24 3.09c.15.2 2.12 3.22 5.14 4.52.72.31 1.28.5 1.72.64.72.23 1.38.2 1.9.12.58-.09 1.77-.72 2.02-1.41.25-.69.25-1.28.17-1.41-.08-.13-.28-.21-.58-.36z"/>
              </svg>
              <a class="muted" href="https://wa.me/254701017246" target="_blank">Chat on WhatsApp</a>
            </li>
            <li>🌐 <a class="muted" href="https://imarika.net" target="_blank">imarika.net</a></li>
          </ul>
        </div>

        <form class="card" onsubmit="return sendEmailViaMailto()">
          <input id="cName" name="Name" placeholder="Your Name" required>
          <input id="cContact" name="Contact" placeholder="Email or Phone" required>
          <textarea id="cMsg" name="Message" placeholder="Message" rows="5" required></textarea>
          <button type="submit" class="btn btn-full">Send</button>
          <p class="helper">This opens your email app to send to <strong>sales@imarika.net</strong>. Prefer WhatsApp? <a href="https://wa.me/254701017246?text=Hello%20Imarika%2C%20I%27d%20like%20some%20help.">Click here</a>.</p>
        </form>
      </div>
    </div>
  </section>

  <footer>
    <div class="container" style="display:flex;align-items:center;justify-content:space-between;gap:1rem;flex-wrap:wrap">
      <div style="display:flex;align-items:center;gap:.6rem">
        <img src="/favicon.svg" class="logo" alt="">
        <span>© <span id="y"></span> Imarika — <a class="muted" href="https://imarika.net">imarika.net</a></span>
      </div>
      <div style="display:flex;align-items:center;gap:.6rem;flex-wrap:wrap">
        <span class="muted">Payments Accepted:&nbsp;</span>
        <img src="/mpesa.png" alt="M-Pesa" style="height:60px;width:auto;vertical-align:middle">
        <span class="muted">·</span>
        <svg width="22" height="22" viewBox="0 0 24 24" aria-hidden="true"><path fill="#334155" d="M3 10.5 12 5l9 5.5v7A1.5 1.5 0 0 1 19.5 19h-15A1.5 1.5 0 0 1 3 17.5z"/><path fill="#94a3b8" d="M12 7.2 5 11v6.5h14V11z"/></svg>
        <strong>Bank Transfer</strong>
      </div>
    </div>
  </footer>

  <!-- Floating WhatsApp -->
  <div class="wa-float">
    <a class="wa-btn" href="https://wa.me/254701017246?text=Hello%20Imarika!" aria-label="Chat on WhatsApp" style="color:#fff">
      <svg aria-hidden="true" viewBox="0 0 24 24" width="26" height="26" fill="currentColor">
        <path d="M20.52 3.48A11.94 11.94 0 0 0 12.06 0C5.52 0 .2 5.32.2 11.86c0 2.08.55 4.08 1.58 5.86L0 24l6.43-1.67a11.82 11.82 0 0 0 5.63 1.43h.01c6.54 0 11.86-5.32 11.86-11.86 0-3.17-1.23-6.14-3.41-8.42zM12.06 21.3h-.01a9.5 9.5 0 0 1-4.85-1.31l-.35-.2-3.82.99 1.02-3.73-.23-.38a9.46 9.46 0 0 1-1.45-5.01c0-5.23 4.26-9.49 9.51-9.49 2.54 0 4.93.99 6.72 2.78a9.43 9.43 0 0 1 2.78 6.71c0 5.23-4.26 9.49-9.52 9.49zm5.47-7.14c-.3-.15-1.77-.87-2.04-.97-.27-.1-.47-.15-.66.15s-.76.97-.92 1.17c-.17.2-.34.22-.63.07-.3-.15-1.26-.46-2.4-1.47-.89-.79-1.49-1.77-1.66-2.07-.17-.3-.02-.46.13-.61.13-.13.3-.34.45-.51.15-.17.2-.3.3-.5.1-.2.05-.37-.02-.53-.07-.15-.66-1.6-.91-2.18-.24-.58-.48-.5-.66-.51l-.56-.01c-.2 0 -.53 .08 -.8 .37 -.27 .3 -1.05 1.02 -1.05 2.49 s 1.08 2.89 1.24 3.09 c .15 .2 2.12 3.22 5.14 4.52 .72 .31 1.28 .5 1.72 .64 .72 .23 1.38 .2 1.9 .12 .58 -.09 1.77 -.72 2.02 -1.41 .25 -.69 .25 -1.28 .17 -1.41 -.08 -.13 -.28 -.21 -.58 -.36 z"/>
      </svg>
    </a>
  </div>

  <!-- Sticky mobile CTA -->
  <div class="sticky-cta">
    <button class="btn btn-wa btn-full" id="stickySignup" style="color:#fff">
      <svg aria-hidden="true" viewBox="0 0 24 24" width="18" height="18" fill="currentColor" style="margin-right:.45rem">
        <path d="M20.52 3.48A11.94 11.94 0 0 0 12.06 0C5.52 0 .2 5.32.2 11.86c0 2.08.55 4.08 1.58 5.86L0 24l6.43-1.67a11.82 11.82 0 0 0 5.63 1.43h.01c6.54 0 11.86-5.32 11.86-11.86 0-3.17-1.23-6.14-3.41-8.42zM12.06 21.3h-.01a9.5 9.5 0 0 1-4.85-1.31l-.35-.2-3.82 .99 1.02 -3.73 -.23 -.38 a9.46 9.46 0 0 1 -1.45 -5.01 c0 -5.23 4.26 -9.49 9.51 -9.49 2.54 0 4.93 .99 6.72 2.78 a9.43 9.43 0 0 1 2.78 6.71 c0 5.23 -4.26 9.49 -9.52 9.49 zm 5.47 -7.14 c -.3 -.15 -1.77 -.87 -2.04 -.97 -.27 -.1 -.47 -.15 -.66 .15 s -.76 .97 -.92 1.17 c -.17 .2 -.34 .22 -.63 .07 -.3 -.15 -1.26 -.46 -2.4 -1.47 -.89 -.79 -1.49 -1.77 -1.66 -2.07 -.17 -.3 -.02 -.46 .13 -.61 .13 -.13 .3 -.34 .45 -.51 .15 -.17 .2 -.3 .3 -.5 .1 -.2 .05 -.37 -.02 -.53 -.07 -.15 -.66 -1.6 -.91 -2.18 -.24 -.58 -.48 -.5 -.66 -.51 l -.56 -.01 c -.2 0 -.53 .08 -.8 .37 -.27 .3 -1.05 1.02 -1.05 2.49 s 1.08 2.89 1.24 3.09 c .15 .2 2.12 3.22 5.14 4.52 .72 .31 1.28 .5 1.72 .64 .72 .23 1.38 .2 1.9 .12 .58 -.09 1.77 -.72 2.02 -1.41 .25 -.69 .25 -1.28 .17 -1.41 -.08 -.13 -.28 -.21 -.58 -.36 z"/>
      </svg>
      Create Account
    </button>
    <button class="btn btn-outline btn-full" id="stickyLogin">Login</button>
  </div>

  <!-- SIGNUP MODAL -->
  <div class="modal" id="signupModal" aria-hidden="true">
    <div class="sheet">
      <h3>Create Account</h3>
      <form class="row" id="signupForm">
        <input id="sFull" placeholder="Full Name (First Middle Last)" required>
        <input id="sId" type="text" inputmode="numeric" placeholder="ID Number *" required>
        <input id="sPhone" type="tel" inputmode="numeric" placeholder="Phone * (10 digits e.g. 07xxxxxxxx or 01xxxxxxxx)" required>
        <input id="sPass" type="password" placeholder="Password *" required>
        <input id="sPass2" type="password" placeholder="Confirm Password *" required>
        <div class="helper">Phone must start with <strong>07</strong> or <strong>01</strong> and be <strong>10 digits</strong>.</div>
        <button class="btn" type="submit">Create Account</button>
        <button class="btn btn-outline" id="closeSignup" type="button">Cancel</button>
        <div class="helper" id="sHint"></div>
      </form>
    </div>
  </div>

  <!-- LOGIN MODAL -->
  <div class="modal" id="loginModal" aria-hidden="true">
    <div class="sheet">
      <h3>Login</h3>
      <form class="row" id="loginForm">
        <input id="lPhone" type="tel" inputmode="numeric" placeholder="Phone (07/01… 10 digits)" required>
        <input id="lPass" type="password" placeholder="Password" required>
        <button class="btn" type="submit">Login</button>
        <button class="btn btn-outline" id="closeLogin" type="button">Cancel</button>
        <div class="helper" id="lHint"></div>
      </form>
    </div>
  </div>

  <script>
    // Footer year
    const y = document.getElementById('y'); if (y) y.textContent = new Date().getFullYear();

    // Desktop menu drawer
    const deskBtn = document.getElementById('deskMenuBtn');
    const deskMenu = document.getElementById('deskMenu');
    if (deskBtn && deskMenu){
      const toggle = () => { deskMenu.style.display = deskMenu.style.display === 'block' ? 'none' : 'block'; };
      deskBtn.addEventListener('click', toggle);
      deskMenu.querySelectorAll('a').forEach(a=>a.addEventListener('click', ()=> deskMenu.style.display='none'));
      document.addEventListener('click', (e)=>{ if(!deskMenu.contains(e.target) && !deskBtn.contains(e.target)) deskMenu.style.display='none'; });
      window.addEventListener('resize', ()=>{ if (window.innerWidth <= 900) deskMenu.style.display = 'none'; });
    }

    // ===== Utilities
    const fmt = (n) => Number(n).toLocaleString('en-KE');
    const phoneOk = (p) => /^0(7|1)\d{8}$/.test(String(p||'').trim());
    const acctNum = () => 'IMK-' + Math.random().toString(36).slice(2,6).toUpperCase() + '-' + Math.floor(Math.random()*9000+1000);

    // ===== AUTH STORAGE (demo only; replace with real API later)
    function saveUser(u){ localStorage.setItem('imarika_user', JSON.stringify(u)); }
    function getUser(){ try{ return JSON.parse(localStorage.getItem('imarika_user')||'null'); }catch{ return null; } }
    function clearUser(){ localStorage.removeItem('imarika_user'); }

    // ===== Signup/Login modal controls
    const signupModal = document.getElementById('signupModal');
    const loginModal  = document.getElementById('loginModal');
    const openSignup = ()=> signupModal.classList.add('active');
    const closeSignup = ()=> signupModal.classList.remove('active');
    const openLogin = ()=> loginModal.classList.add('active');
    const closeLogin = ()=> loginModal.classList.remove('active');

    ['signupBtn','ctaSignup','stickySignup'].forEach(id=>{
      const el = document.getElementById(id); if(el) el.addEventListener('click', openSignup);
    });
    ['loginBtn','ctaLogin','stickyLogin'].forEach(id=>{
      const el = document.getElementById(id); if(el) el.addEventListener('click', openLogin);
    });
    document.getElementById('closeSignup').addEventListener('click', closeSignup);
    document.getElementById('closeLogin').addEventListener('click', closeLogin);
    signupModal.addEventListener('click', (e)=>{ if(e.target===signupModal) closeSignup(); });
    loginModal.addEventListener('click',  (e)=>{ if(e.target===loginModal)  closeLogin(); });

    // ===== Signup handler
    const sForm = document.getElementById('signupForm');
    const sHint = document.getElementById('sHint');
    sForm.addEventListener('submit', async (e)=>{
      e.preventDefault();
      const full = document.getElementById('sFull').value.trim();
      const idn  = document.getElementById('sId').value.trim();
      const phone= document.getElementById('sPhone').value.trim();
      const pass = document.getElementById('sPass').value;
      const pass2= document.getElementById('sPass2').value;

      if(!full || !idn){ sHint.textContent = 'Name and ID are required.'; sHint.style.color='var(--danger)'; return; }
      if(!phoneOk(phone)){ sHint.textContent = 'Phone must start with 07/01 and be 10 digits.'; sHint.style.color='var(--danger)'; return; }
      if(pass.length < 6){ sHint.textContent = 'Password must be at least 6 characters.'; sHint.style.color='var(--danger)'; return; }
      if(pass !== pass2){ sHint.textContent = 'Passwords do not match.'; sHint.style.color='var(--danger)'; return; }

      // TODO: Replace with real API call (signup), then send OTP below.
      const user = {
        full, idn, phone,
        passHash: btoa(pass), // demo only — replace with real hashing server-side
        account: acctNum(),
        wallet: 0,
        invested: 0,
        createdAt: Date.now()
      };
      saveUser(user);

      // Demo OTP step — in production call SMS provider and verify
      const code = String(Math.floor(100000 + Math.random()*900000));
      sessionStorage.setItem('imarika_last_otp', code);
      alert(`Demo OTP (dev only): ${code}\n\nReplace this with real SMS OTP.`);

      sHint.textContent = 'Account created. Enter the OTP sent to your phone (demo alert shown).';
      sHint.style.color = 'var(--ok)';
      closeSignup();
      openLogin();
      document.getElementById('lPhone').value = phone;
    });

    // ===== Login handler
    const lForm = document.getElementById('loginForm');
    const lHint = document.getElementById('lHint');
    lForm.addEventListener('submit', (e)=>{
      e.preventDefault();
      const phone = document.getElementById('lPhone').value.trim();
      const pass  = document.getElementById('lPass').value;

      const u = getUser();
      if(!u || u.phone !== phone || u.passHash !== btoa(pass)){
        lHint.textContent = 'Invalid phone or password.'; lHint.style.color='var(--danger)'; return;
      }

      // Optional: prompt for OTP during login too (commented)
      // const otp = prompt('Enter OTP (demo: ' + (sessionStorage.getItem("imarika_last_otp")||'000000') + ')');
      // if(!otp || otp !== sessionStorage.getItem('imarika_last_otp')) { alert('Invalid OTP'); return; }

      lHint.textContent = 'Success!'; lHint.style.color='var(--ok)';
      closeLogin();
      showDashboard(u);
      window.scrollTo({top:0, behavior:'smooth'});
    });

    // ===== Dashboard wiring
    const dash = document.getElementById('dashboard');
    const acctTag = document.getElementById('acctTag');
    const walletBal = document.getElementById('walletBal');
    const invBal = document.getElementById('invBal');
    const walletUpdated = document.getElementById('walletUpdated');

    function showDashboard(u){
      acctTag.textContent = 'Acct: ' + u.account;
      walletBal.textContent = 'KES ' + fmt(u.wallet);
      invBal.textContent = 'KES ' + fmt(u.invested);
      walletUpdated.textContent = 'Updated ' + new Date().toLocaleString();
      dash.style.display = 'block';
    }

    // On load, if user exists, show dashboard
    const existing = getUser();
    if(existing) showDashboard(existing);

    // Deposit / Withdraw placeholders
    document.getElementById('depositBtn').addEventListener('click', ()=>{
      // Later we’ll route to a deposit page or STK Push
      alert('Deposit placeholder: we will integrate M-Pesa STK Push / Paybill next.');
    });
    document.getElementById('withdrawBtn').addEventListener('click', ()=>{
      alert('Withdraw placeholder: requires KYC + balance + backend.');
    });

    // Mini calculator in dashboard
    document.getElementById('miniCalcBtn').addEventListener('click', ()=>{
      const plan = document.getElementById('miniPlan').value;
      const amt  = Number(document.getElementById('miniAmt').value||0);
      const cfg = { std:30, gold:50, plat:70 }[plan];
      if(!amt || amt < 1000){ document.getElementById('miniOut').textContent='Enter at least KES 1,000'; return; }
      const earn = Math.round(amt * cfg/100);
      document.getElementById('miniOut').innerHTML = `Projected earnings in 24h: <strong style="color:var(--ok)">KES ${fmt(earn)}</strong> • Total: <strong>KES ${fmt(amt+earn)}</strong>`;
    });
    document.getElementById('miniStartBtn').addEventListener('click', ()=>{
      alert('We will redirect to Deposit → M-Pesa pay flow with prefilled amount and selected plan.');
    });

    // Contact form mailto (unchanged)
    function sendEmailViaMailto(){
      const name = (document.getElementById('cName').value||'').trim();
      const contact = (document.getElementById('cContact').value||'').trim();
      const msg = (document.getElementById('cMsg').value||'').trim();
      if(!name || !contact || !msg){ alert('Please fill your Name, Contact and Message.'); return false; }
      const subject = encodeURIComponent(`New inquiry from ${name}`);
      const body = encodeURIComponent(`Name: ${name}\nContact: ${contact}\n\n${msg}`);
      window.location.href = `mailto:sales@imarika.net?subject=${subject}&body=${body}`;
      return false;
    }
    window.sendEmailViaMailto = sendEmailViaMailto;
  </script>
</body>
</html>
