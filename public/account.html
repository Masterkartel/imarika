<!doctype html>
<html lang="en">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Account | Imarika</title>
<link rel="icon" href="/favicon.svg">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
  :root{--bg:#fff;--text:#0f172a;--muted:#475569;--line:#e5e7eb;--card:#fff;--brand:#f59e0b;--ring:rgba(245,158,11,.35)}
  *{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
  a{text-decoration:none;color:inherit}
  .container{max-width:920px;margin:0 auto;padding:0 1rem}
  header{position:sticky;top:0;background:rgba(255,255,255,.9);backdrop-filter:blur(8px);border-bottom:1px solid var(--line);z-index:40}
  .brand{display:flex;align-items:center;gap:.55rem;height:64px}
  .logo{height:32px;width:32px;border-radius:10px}
  .grid{display:grid;gap:1rem}
  @media(min-width:768px){.grid2{grid-template-columns:1fr 1fr}}
  .card{background:#fff;border:1px solid var(--line);border-radius:18px;padding:1.15rem;box-shadow:0 10px 30px rgba(2,8,23,.06)}
  input{width:100%;padding:.85rem;border:1px solid var(--line);border-radius:14px;outline:none}
  input:focus{border-color:#cbd5e1;box-shadow:0 0 0 4px var(--ring)}
  .btn{display:inline-flex;align-items:center;justify-content:center;padding:.8rem 1rem;border-radius:14px;font-weight:700;background:var(--brand);color:#111827;border:0;cursor:pointer;box-shadow:0 10px 30px rgba(245,158,11,.25)}
  .btn-outline{background:#fff;border:1px solid var(--line)}
  .muted{color:var(--muted)}
</style>

<body>
  <header>
    <div class="container" style="display:flex;align-items:center;justify-content:space-between">
      <a class="brand" href="/"><img src="/favicon.svg" class="logo" alt=""><strong>Imarika</strong></a>
      <a class="btn-outline" style="padding:.55rem .8rem;border-radius:12px" href="/">← Home</a>
    </div>
  </header>

  <section>
    <div class="container">
      <h1 style="margin:1rem 0 .5rem">Welcome</h1>
      <p class="muted" style="margin-top:0">Create an account or log in to access your dashboard.</p>

      <div class="grid grid2" style="margin-top:1rem">
        <form id="sForm" class="card" onsubmit="return false;" style="display:grid;gap:.6rem">
          <h3>Create Account</h3>
          <input id="sFull" placeholder="Full Name (First Middle Last)" required>
          <input id="sId" inputmode="numeric" placeholder="ID Number *" required>
          <input id="sPhone" inputmode="tel" placeholder="Phone * (07/01… 10 digits)" required>
          <input id="sPass" type="password" placeholder="Password * (min 6 chars)" required>
          <input id="sPass2" type="password" placeholder="Confirm Password *" required>
          <button class="btn" id="sBtn">Create Account</button>
          <div class="muted" id="sHint"></div>
        </form>

        <form id="lForm" class="card" onsubmit="return false;" style="display:grid;gap:.6rem">
          <h3>Login</h3>
          <input id="lPhone" inputmode="tel" placeholder="Phone (07/01… 10 digits)" required>
          <input id="lPass" type="password" placeholder="Password" required>
          <button class="btn" id="lBtn">Login</button>
          <div class="muted" id="lHint"></div>
        </form>
      </div>
    </div>
  </section>

  <script>
    // same storage model as dashboard
    const phoneOk = p => /^0(7|1)\d{8}$/.test(String(p||'').trim());
    const acctNum = () => 'IMK-' + Math.random().toString(36).slice(2,6).toUpperCase() + '-' + Math.floor(Math.random()*9000+1000);
    const saveUser = u => localStorage.setItem('imarika_user', JSON.stringify(u));
    const getUser  = () => { try { return JSON.parse(localStorage.getItem('imarika_user')||'null'); } catch { return null; } };

    // If already logged in, go to dashboard
    if (getUser()) window.location.replace('/dashboard');

    // Sign up
    const sHint = document.getElementById('sHint');
    document.getElementById('sBtn').onclick = () => {
      const full=sFull.value.trim(), idn=sId.value.trim(), phone=sPhone.value.trim(), pass=sPass.value, pass2=sPass2.value;
      if(!full||!idn){ sHint.textContent='Name and ID are required.'; return; }
      if(!phoneOk(phone)){ sHint.textContent='Phone must start with 07/01 and be 10 digits.'; return; }
      if(pass.length<6){ sHint.textContent='Password must be at least 6 characters.'; return; }
      if(pass!==pass2){ sHint.textContent='Passwords do not match.'; return; }
      const user={ full,idn,phone,passHash:btoa(pass),account:acctNum(),wallet:0,invested:0,createdAt:Date.now() };
      saveUser(user);
      window.location.href='/dashboard';
    };

    // Login
    const lHint = document.getElementById('lHint');
    document.getElementById('lBtn').onclick = () => {
      const u=getUser(), phone=lPhone.value.trim(), pass=lPass.value;
      if(!u || u.phone!==phone || u.passHash!==btoa(pass)){ lHint.textContent='Invalid phone or password.'; return; }
      window.location.href='/dashboard';
    };
  </script>
</body>
</html>
